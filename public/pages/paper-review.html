<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë…¼ë¬¸ ë¦¬ë·° - ë‚˜ì˜ í•™ìŠµ í¬íŠ¸í´ë¦¬ì˜¤</title>
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/pages.css">
</head>
<body>
    <header>
        <div class="container">
            <nav class="breadcrumb">
                <a href="../index.html">í™ˆ</a> > <span>ë…¼ë¬¸ ë¦¬ë·°</span>
            </nav>
            <h1>ğŸ“„ ë…¼ë¬¸ ë¦¬ë·°</h1>
            <p>ìµœì‹  ì—°êµ¬ ë…¼ë¬¸ ë¶„ì„ ë° ì •ë¦¬</p>
        </div>
    </header>

    <main>
        <div class="container">
            <div class="page-actions">
                <button class="btn-primary" onclick="showAddForm()">ìƒˆ ë…¼ë¬¸ ë¦¬ë·° ì‘ì„±</button>
            </div>

            <!-- ìƒˆ ë…¼ë¬¸ ë¦¬ë·° ì¶”ê°€ í¼ -->
            <div id="add-form" class="add-form" style="display: none;">
                <h3>ìƒˆ ë…¼ë¬¸ ë¦¬ë·° ì‘ì„±</h3>
                <form id="paper-form">
                    <div class="form-group">
                        <label for="title">ë…¼ë¬¸ ì œëª©</label>
                        <input type="text" id="title" name="title" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="authors">ì €ìë“¤</label>
                        <input type="text" id="authors" name="authors" placeholder="ì˜ˆ: John Doe, Jane Smith" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="summary">ìš”ì•½</label>
                        <textarea id="summary" name="summary" rows="3" placeholder="ë…¼ë¬¸ì˜ í•µì‹¬ ë‚´ìš©ì„ ê°„ë‹¨íˆ ìš”ì•½í•´ì£¼ì„¸ìš”" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="content">ìƒì„¸ ë¦¬ë·°</label>
                        <textarea id="content" name="content" rows="10" placeholder="ë…¼ë¬¸ì— ëŒ€í•œ ìƒì„¸í•œ ë¶„ì„ê³¼ ë¦¬ë·°ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="tags">íƒœê·¸</label>
                        <input type="text" id="tags" name="tags" placeholder="ì‰¼í‘œë¡œ êµ¬ë¶„í•˜ì—¬ ì…ë ¥ (ì˜ˆ: AI, ë¨¸ì‹ ëŸ¬ë‹, ë”¥ëŸ¬ë‹)">
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn-primary">ì €ì¥</button>
                        <button type="button" class="btn-secondary" onclick="hideAddForm()">ì·¨ì†Œ</button>
                    </div>
                </form>
            </div>

            <!-- ë…¼ë¬¸ ë¦¬ë·° ëª©ë¡ -->
            <div class="content-list" id="papers-container">
                <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024 ë‚˜ì˜ í•™ìŠµ í¬íŠ¸í´ë¦¬ì˜¤. ëª¨ë“  ê¶Œë¦¬ ë³´ìœ .</p>
        </div>
    </footer>

    <script>
        // í¼ í‘œì‹œ/ìˆ¨ê¸°ê¸°
        function showAddForm() {
            document.getElementById('add-form').style.display = 'block';
            document.getElementById('title').focus();
        }
        
        function hideAddForm() {
            document.getElementById('add-form').style.display = 'none';
            document.getElementById('paper-form').reset();
        }

        // ë…¼ë¬¸ ë¦¬ë·° ëª©ë¡ ë¡œë“œ
        async function loadPapers() {
            try {
                const response = await fetch('/api/papers');
                const papers = await response.json();
                
                const container = document.getElementById('papers-container');
                
                if (papers.length === 0) {
                    container.innerHTML = '<p class="no-content">ì•„ì§ ì‘ì„±ëœ ë…¼ë¬¸ ë¦¬ë·°ê°€ ì—†ìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ ë¦¬ë·°ë¥¼ ì‘ì„±í•´ë³´ì„¸ìš”!</p>';
                    return;
                }
                
                container.innerHTML = papers.map(paper => `
                    <article class="content-item">
                        <div class="content-header">
                            <h3>${paper.title}</h3>
                            <span class="content-date">${paper.date}</span>
                        </div>
                        <p class="content-meta">ì €ì: ${paper.authors}</p>
                        <div class="content-summary">
                            <p>${paper.summary}</p>
                        </div>
                        <div class="content-body">
                            <p>${paper.content.substring(0, 200)}${paper.content.length > 200 ? '...' : ''}</p>
                        </div>
                        ${paper.tags && paper.tags.length > 0 ? `
                            <div class="content-tags">
                                ${paper.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                            </div>
                        ` : ''}
                    </article>
                `).join('');
            } catch (error) {
                console.error('Error loading papers:', error);
                document.getElementById('papers-container').innerHTML = 
                    '<p class="error">ë…¼ë¬¸ ë¦¬ë·°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</p>';
            }
        }

        // ìƒˆ ë…¼ë¬¸ ë¦¬ë·° ì €ì¥
        document.getElementById('paper-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const data = {
                title: formData.get('title'),
                authors: formData.get('authors'),
                summary: formData.get('summary'),
                content: formData.get('content'),
                tags: formData.get('tags') ? formData.get('tags').split(',').map(tag => tag.trim()) : []
            };
            
            try {
                const response = await fetch('/api/papers', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    hideAddForm();
                    loadPapers(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                    alert('ë…¼ë¬¸ ë¦¬ë·°ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
                } else {
                    alert('ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + result.message);
                }
            } catch (error) {
                console.error('Error saving paper:', error);
                alert('ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë…¼ë¬¸ ëª©ë¡ ë¡œë“œ
        document.addEventListener('DOMContentLoaded', loadPapers);
    </script>
</body>
</html>